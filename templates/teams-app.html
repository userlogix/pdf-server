<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Toolkit - Teams App</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* === CORE BRAND COLORS === */
            --zeal-brand-primary: #462b91;
            --zeal-ai-primary: #4461D7;
            --zeal-bridge-purple: #6c5ce7;
            --zeal-light-accent: #a29bfe;
            
            /* === ACTION COLORS === */
            --zeal-success-primary: #10b981;
            --zeal-success-secondary: #059669;
            --zeal-error-primary: #ef4444;
            --zeal-error-secondary: #dc2626;
            --zeal-warning-primary: #f59e0b;
            --zeal-warning-secondary: #d97706;
            --zeal-info-primary: #06b6d4;
            --zeal-info-secondary: #0891b2;
            
            /* === NEUTRALS === */
            --zeal-gray-dark: #2d3748;
            --zeal-gray-medium: #718096;
            --zeal-gray-light: #e2e8f0;
            --zeal-background-light: #f7fafc;
            
            /* === BRAND GRADIENTS === */
            --zeal-gradient-primary: linear-gradient(135deg, var(--zeal-brand-primary) 0%, var(--zeal-bridge-purple) 100%);
            --zeal-gradient-ai-primary: linear-gradient(135deg, var(--zeal-ai-primary) 0%, var(--zeal-brand-primary) 100%);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: transparent;
            color: var(--zeal-gray-dark);
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 12px;
        }

        .header {
            background: rgba(255, 255, 255, 0.8);
            padding: 16px 20px;
            border-radius: 8px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            border: 1px solid rgba(0,0,0,0.08);
        }

        .header h1 {
            background: var(--zeal-gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 4px;
            font-size: 1.6rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header p {
            color: var(--zeal-gray-medium);
            font-size: 0.9rem;
            margin: 0;
        }

        /* Brand Icons */
        .brand-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .brand-icon.regular {
            background: var(--zeal-gradient-ai-primary);
            color: white;
        }

        .brand-icon.outline {
            background: white;
            color: var(--zeal-ai-primary);
            border: 2px solid var(--zeal-ai-primary);
        }

        .back-button {
            background: var(--zeal-gradient-ai-primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 12px;
            display: none;
            align-items: center;
            gap: 6px;
            transition: all 0.2s ease;
            box-shadow: 0 1px 4px rgba(68, 97, 215, 0.2);
        }

        .back-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(68, 97, 215, 0.3);
        }

        /* Main Menu Styles */
        .main-menu {
            display: block;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 12px;
            margin-top: 12px;
        }

        .menu-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 8px;
            padding: 16px;
            box-shadow: 0 1px 6px rgba(0,0,0,0.06);
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid rgba(0,0,0,0.08);
            position: relative;
            overflow: hidden;
        }

        .menu-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(68, 97, 215, 0.12);
            border-color: var(--zeal-ai-primary);
            background: rgba(255, 255, 255, 0.95);
        }

        .menu-card-icon {
            font-size: 1.8rem;
            background: var(--zeal-gradient-ai-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .menu-card h3 {
            color: var(--zeal-gray-dark);
            margin-bottom: 6px;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .menu-card p {
            color: var(--zeal-gray-medium);
            line-height: 1.4;
            font-size: 0.85rem;
            margin: 0;
        }

        /* Operation Page Styles */
        .operation-page {
            display: none;
        }

        .operation-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            border: 1px solid rgba(0,0,0,0.08);
            max-width: 600px;
            margin: 0 auto;
        }

        .operation-card h2 {
            background: var(--zeal-gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Input Method Toggle */
        .input-toggle {
            display: flex;
            background: var(--zeal-gray-light);
            border-radius: 8px;
            padding: 3px;
            margin-bottom: 16px;
            position: relative;
        }

        .toggle-option {
            flex: 1;
            padding: 8px 14px;
            text-align: center;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.2s ease;
            font-weight: 500;
            font-size: 0.85rem;
            color: var(--zeal-gray-medium);
            z-index: 2;
            position: relative;
        }

        .toggle-option.active {
            color: white;
        }

        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            right: 50%;
            bottom: 3px;
            background: var(--zeal-gradient-ai-primary);
            border-radius: 5px;
            transition: all 0.2s ease;
            z-index: 1;
        }

        .toggle-slider.url-active {
            left: 50%;
            right: 3px;
        }

        /* Input Sections */
        .input-section {
            display: none;
        }

        .input-section.active {
            display: block;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--zeal-gray-dark);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .form-control {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--zeal-gray-light);
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s ease;
            background: white;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--zeal-ai-primary);
            box-shadow: 0 0 0 2px rgba(68, 97, 215, 0.1);
        }

        .file-upload {
            border: 1px dashed var(--zeal-gray-light);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(248, 250, 252, 0.5);
            position: relative;
        }

        .file-upload:hover {
            border-color: var(--zeal-ai-primary);
            background: rgba(68, 97, 215, 0.02);
        }

        .file-upload.dragover {
            border-color: var(--zeal-ai-primary);
            background: rgba(68, 97, 215, 0.05);
            transform: scale(1.01);
        }

        .file-upload-icon {
            font-size: 2rem;
            background: var(--zeal-gradient-ai-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .file-upload p {
            color: var(--zeal-gray-dark);
            margin-bottom: 4px;
            font-size: 0.95rem;
            font-weight: 500;
        }

        .file-upload small {
            color: var(--zeal-gray-medium);
            font-size: 0.8rem;
        }

        .filename-display {
            margin-top: 10px;
            padding: 6px 12px;
            background: var(--zeal-gradient-ai-primary);
            color: white;
            border-radius: 4px;
            font-weight: 500;
            font-size: 0.85rem;
            display: none;
        }

        .btn {
            background: var(--zeal-gradient-ai-primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            width: 100%;
            justify-content: center;
            margin-top: 16px;
            box-shadow: 0 2px 8px rgba(68, 97, 215, 0.2);
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(68, 97, 215, 0.3);
        }

        .btn:disabled {
            background: var(--zeal-gray-light);
            color: var(--zeal-gray-medium);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .progress {
            width: 100%;
            height: 4px;
            background: var(--zeal-gray-light);
            border-radius: 2px;
            overflow: hidden;
            margin: 12px 0;
            display: none;
        }

        .progress-bar {
            height: 100%;
            background: var(--zeal-gradient-ai-primary);
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 2px;
        }

        .result {
            background: rgba(68, 97, 215, 0.03);
            border: 1px solid var(--zeal-ai-primary);
            border-radius: 6px;
            padding: 12px;
            margin-top: 12px;
            display: none;
            font-size: 0.9rem;
        }

        .result.success {
            background: rgba(16, 185, 129, 0.03);
            border-color: var(--zeal-success-primary);
        }

        .result.error {
            background: rgba(239, 68, 68, 0.03);
            border-color: var(--zeal-error-primary);
        }

        .download-link {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            margin-top: 8px;
            padding: 8px 16px;
            background: var(--zeal-gradient-primary);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            font-weight: 500;
            font-size: 0.85rem;
            transition: all 0.2s ease;
            box-shadow: 0 1px 4px rgba(70, 43, 145, 0.2);
        }

        .download-link:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(70, 43, 145, 0.3);
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 14px;
            background: rgba(68, 97, 215, 0.02);
            border-radius: 6px;
            border: 1px solid rgba(68, 97, 215, 0.1);
        }

        .checkbox-group input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .menu-grid {
                grid-template-columns: 1fr;
            }

            .operation-card {
                padding: 16px;
                margin: 0 8px;
            }

            .container {
                padding: 8px;
            }

            .header {
                padding: 12px 16px;
            }

            .header h1 {
                font-size: 1.4rem;
            }
        }


    </style>
</head>
<body>

        <div class="container">
            <!-- Header -->
            <div class="header">
                <h1>
                    <i class="fa-solid fa-file-pdf"></i> PDF Toolkit
                </h1>
                <p id="user-info">Processing PDFs made simple</p>
            </div>

            <!-- Back Button -->
            <button class="back-button" onclick="showMainMenu()">
                <i class="fas fa-arrow-left"></i> Back to Menu
            </button>

            <!-- Main Menu -->
            <div id="main-menu" class="main-menu">
                <div class="menu-grid">
                    <!-- Only include operations that have corresponding pages -->
                    <div class="menu-card" onclick="showOperation('compress')">
                        <div class="menu-card-icon">
                            <i class="fas fa-compress-alt"></i>
                        </div>
                        <h3>Compress PDF</h3>
                        <p>Reduce file size with quality control and page limiting options</p>
                    </div>

                    <div class="menu-card" onclick="showOperation('merge')">
                        <div class="menu-card-icon">
                            <i class="fas fa-object-group"></i>
                        </div>
                        <h3>Merge PDFs</h3>
                        <p>Combine multiple PDF documents into a single file</p>
                    </div>

                    <div class="menu-card" onclick="showOperation('convert')">
                        <div class="menu-card-icon">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <h3>Convert to PDF</h3>
                        <p>Convert Word, Excel, PowerPoint, images, and text files to PDF</p>
                    </div>

                    <div class="menu-card" onclick="showOperation('image-to-pdf')">
                        <div class="menu-card-icon">
                            <i class="fas fa-image"></i>
                        </div>
                        <h3>Image to PDF</h3>
                        <p>Convert images to PDF with optional titles and formatting</p>
                    </div>

                    <div class="menu-card" onclick="showOperation('watermark')">
                        <div class="menu-card-icon">
                            <i class="fas fa-stamp"></i>
                        </div>
                        <h3>Add Watermark</h3>
                        <p>Add custom text watermarks with opacity and positioning</p>
                    </div>

                    <div class="menu-card" onclick="showOperation('password-protect')">
                        <div class="menu-card-icon">
                            <i class="fas fa-lock"></i>
                        </div>
                        <h3>Password Protect</h3>
                        <p>Encrypt PDF documents with password protection</p>
                    </div>

                    <div class="menu-card" onclick="showOperation('password-remove')">
                        <div class="menu-card-icon">
                            <i class="fas fa-unlock"></i>
                        </div>
                        <h3>Remove Password</h3>
                        <p>Remove password protection from encrypted PDFs</p>
                    </div>

                    <div class="menu-card" onclick="showOperation('searchable')">
                        <div class="menu-card-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <h3>Make Searchable</h3>
                        <p>Add OCR text layer to scanned PDFs for text search</p>
                    </div>
                </div>
            </div>

            <!-- Operation Pages -->

            <!-- Compress PDF -->
            <div id="compress-page" class="operation-page">
                <div class="operation-card">
                    <h2><i class="fas fa-compress-alt"></i> Compress PDF</h2>
                    
                    <!-- Input Method Toggle -->
                    <div class="input-toggle">
                        <div class="toggle-slider" id="compress-slider"></div>
                        <div class="toggle-option active" onclick="switchInputMethod('compress', 'file')">
                            <i class="fas fa-upload"></i> Upload File
                        </div>
                        <div class="toggle-option" onclick="switchInputMethod('compress', 'url')">
                            <i class="fas fa-link"></i> From URL
                        </div>
                    </div>

                    <!-- File Upload Section -->
                    <div id="compress-file-section" class="input-section active">
                        <div class="form-group">
                            <div class="file-upload" onclick="document.getElementById('compress-file').click()" 
                                 ondrop="handleFileDrop(event, 'compress-file')" 
                                 ondragover="event.preventDefault()" 
                                 ondragenter="event.target.classList.add('dragover')" 
                                 ondragleave="event.target.classList.remove('dragover')">
                                <input type="file" id="compress-file" accept=".pdf" style="display:none" onchange="updateFileName(this, 'compress')">
                                <div class="file-upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <p>Drop PDF here or click to select</p>
                                <small>PDF files only</small>
                                <div id="compress-filename" class="filename-display"></div>
                            </div>
                        </div>
                    </div>

                    <!-- URL Section -->
                    <div id="compress-url-section" class="input-section">
                        <div class="form-group">
                            <label><i class="fas fa-link"></i> PDF URL:</label>
                            <input type="url" id="compress-url" class="form-control" placeholder="https://example.com/document.pdf">
                        </div>
                    </div>

                    <!-- Settings -->
                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-cog"></i> Compression Level:</label>
                            <select id="compress-level" class="form-control">
                                <option value="screen">Screen (Smallest size)</option>
                                <option value="ebook" selected>eBook (Balanced)</option>
                                <option value="printer">Printer (High quality)</option>
                                <option value="prepress">Prepress (Highest quality)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-file-alt"></i> Max Pages (optional):</label>
                            <input type="number" id="compress-max-pages" class="form-control" placeholder="All pages">
                        </div>
                    </div>

                    <button class="btn" onclick="compressPDF()">
                        <i class="fas fa-compress-alt"></i> Compress PDF
                    </button>

                    <div id="compress-progress" class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <div id="compress-result" class="result"></div>
                </div>
            </div>

            <!-- Merge PDFs -->
            <div id="merge-page" class="operation-page">
                <div class="operation-card">
                    <h2><i class="fas fa-object-group"></i> Merge PDFs</h2>
                    
                    <!-- Input Method Toggle -->
                    <div class="input-toggle">
                        <div class="toggle-slider" id="merge-slider"></div>
                        <div class="toggle-option active" onclick="switchInputMethod('merge', 'file')">
                            <i class="fas fa-upload"></i> Upload Files
                        </div>
                        <div class="toggle-option" onclick="switchInputMethod('merge', 'url')">
                            <i class="fas fa-link"></i> From URLs
                        </div>
                    </div>

                    <!-- File Upload Section -->
                    <div id="merge-file-section" class="input-section active">
                        <div class="form-group">
                            <div class="file-upload" onclick="document.getElementById('merge-files').click()" 
                                 ondrop="handleFileDrop(event, 'merge-files')" 
                                 ondragover="event.preventDefault()" 
                                 ondragenter="event.target.classList.add('dragover')" 
                                 ondragleave="event.target.classList.remove('dragover')">
                                <input type="file" id="merge-files" accept=".pdf" multiple style="display:none" onchange="updateFileName(this, 'merge')">
                                <div class="file-upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <p>Drop multiple PDFs here or click to select</p>
                                <small>Select multiple PDF files</small>
                                <div id="merge-filename" class="filename-display"></div>
                            </div>
                        </div>
                    </div>

                    <!-- URL Section -->
                    <div id="merge-url-section" class="input-section">
                        <div class="form-group">
                            <label><i class="fas fa-link"></i> PDF URLs (comma-separated):</label>
                            <textarea id="merge-urls" class="form-control" rows="4" placeholder="https://example.com/doc1.pdf, https://example.com/doc2.pdf"></textarea>
                        </div>
                    </div>

                    <button class="btn" onclick="mergePDFs()">
                        <i class="fas fa-object-group"></i> Merge PDFs
                    </button>

                    <div id="merge-progress" class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <div id="merge-result" class="result"></div>
                </div>
            </div>

            <!-- Convert to PDF -->
            <div id="convert-page" class="operation-page">
                <div class="operation-card">
                    <h2><i class="fas fa-exchange-alt"></i> Convert to PDF</h2>
                    
                    <!-- Input Method Toggle -->
                    <div class="input-toggle">
                        <div class="toggle-slider" id="convert-slider"></div>
                        <div class="toggle-option active" onclick="switchInputMethod('convert', 'file')">
                            <i class="fas fa-upload"></i> Upload File
                        </div>
                        <div class="toggle-option" onclick="switchInputMethod('convert', 'url')">
                            <i class="fas fa-link"></i> From URL
                        </div>
                    </div>

                    <!-- File Upload Section -->
                    <div id="convert-file-section" class="input-section active">
                        <div class="form-group">
                            <div class="file-upload" onclick="document.getElementById('convert-file').click()" 
                                 ondrop="handleFileDrop(event, 'convert-file')" 
                                 ondragover="event.preventDefault()" 
                                 ondragenter="event.target.classList.add('dragover')" 
                                 ondragleave="event.target.classList.remove('dragover')">
                                <input type="file" id="convert-file" style="display:none" onchange="updateFileName(this, 'convert')" 
                                       accept=".docx,.doc,.xlsx,.xls,.pptx,.ppt,.odt,.ods,.odp,.jpg,.jpeg,.png,.gif,.bmp,.tiff,.txt,.rtf">
                                <div class="file-upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <p>Drop any document or image here</p>
                                <small>Word, Excel, PowerPoint, Images, Text files</small>
                                <div id="convert-filename" class="filename-display"></div>
                            </div>
                        </div>
                    </div>

                    <!-- URL Section -->
                    <div id="convert-url-section" class="input-section">
                        <div class="form-group">
                            <label><i class="fas fa-link"></i> File URL:</label>
                            <input type="url" id="convert-url" class="form-control" placeholder="https://example.com/document.docx">
                        </div>
                    </div>

                    <!-- Settings -->
                    <div class="form-group">
                        <label><i class="fas fa-heading"></i> Title (for images):</label>
                        <input type="text" id="convert-title" class="form-control" placeholder="Optional title for image conversions">
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="convert-fit-letter">
                            <label for="convert-fit-letter"><i class="fas fa-expand-arrows-alt"></i> Fit images to letter size (8.5×11)</label>
                        </div>
                    </div>

                    <button class="btn" onclick="convertToPDF()">
                        <i class="fas fa-exchange-alt"></i> Convert to PDF
                    </button>

                    <div id="convert-progress" class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <div id="convert-result" class="result"></div>
                </div>
            </div>

            <!-- Add Watermark -->
            <div id="watermark-page" class="operation-page">
                <div class="operation-card">
                    <h2><i class="fas fa-stamp"></i> Add Watermark</h2>
                    
                    <!-- Input Method Toggle -->
                    <div class="input-toggle">
                        <div class="toggle-slider" id="watermark-slider"></div>
                        <div class="toggle-option active" onclick="switchInputMethod('watermark', 'file')">
                            <i class="fas fa-upload"></i> Upload File
                        </div>
                        <div class="toggle-option" onclick="switchInputMethod('watermark', 'url')">
                            <i class="fas fa-link"></i> From URL
                        </div>
                    </div>

                    <!-- File Upload Section -->
                    <div id="watermark-file-section" class="input-section active">
                        <div class="form-group">
                            <div class="file-upload" onclick="document.getElementById('watermark-file').click()" 
                                 ondrop="handleFileDrop(event, 'watermark-file')" 
                                 ondragover="event.preventDefault()" 
                                 ondragenter="event.target.classList.add('dragover')" 
                                 ondragleave="event.target.classList.remove('dragover')">
                                <input type="file" id="watermark-file" accept=".pdf" style="display:none" onchange="updateFileName(this, 'watermark')">
                                <div class="file-upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <p>Drop PDF here or click to select</p>
                                <small>PDF files only</small>
                                <div id="watermark-filename" class="filename-display"></div>
                            </div>
                        </div>
                    </div>

                    <!-- URL Section -->
                    <div id="watermark-url-section" class="input-section">
                        <div class="form-group">
                            <label><i class="fas fa-link"></i> PDF URL:</label>
                            <input type="url" id="watermark-url" class="form-control" placeholder="https://example.com/document.pdf">
                        </div>
                    </div>

                    <!-- Settings -->
                    <div class="form-group">
                        <label><i class="fas fa-font"></i> Watermark Text:</label>
                        <input type="text" id="watermark-text" class="form-control" placeholder="CONFIDENTIAL" value="CONFIDENTIAL">
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label><i class="fas fa-eye"></i> Opacity (0.0 - 1.0):</label>
                            <input type="number" id="watermark-opacity" class="form-control" min="0" max="1" step="0.1" value="0.3">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-map-marker-alt"></i> Position:</label>
                            <select id="watermark-position" class="form-control">
                                <option value="center" selected>Center</option>
                                <option value="top_left">Top Left</option>
                                <option value="top_right">Top Right</option>
                                <option value="bottom_left">Bottom Left</option>
                                <option value="bottom_right">Bottom Right</option>
                            </select>
                        </div>
                    </div>

                    <button class="btn" onclick="addWatermark()">
                        <i class="fas fa-stamp"></i> Add Watermark
                    </button>

                    <div id="watermark-progress" class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <div id="watermark-result" class="result"></div>
                </div>
            </div>

            <!-- Password Protect -->
            <div id="password-protect-page" class="operation-page">
                <div class="operation-card">
                    <h2><i class="fas fa-lock"></i> Password Protect PDF</h2>
                    
                    <!-- Input Method Toggle -->
                    <div class="input-toggle">
                        <div class="toggle-slider" id="protect-slider"></div>
                        <div class="toggle-option active" onclick="switchInputMethod('protect', 'file')">
                            <i class="fas fa-upload"></i> Upload File
                        </div>
                        <div class="toggle-option" onclick="switchInputMethod('protect', 'url')">
                            <i class="fas fa-link"></i> From URL
                        </div>
                    </div>

                    <!-- File Upload Section -->
                    <div id="protect-file-section" class="input-section active">
                        <div class="form-group">
                            <div class="file-upload" onclick="document.getElementById('protect-file').click()" 
                                 ondrop="handleFileDrop(event, 'protect-file')" 
                                 ondragover="event.preventDefault()" 
                                 ondragenter="event.target.classList.add('dragover')" 
                                 ondragleave="event.target.classList.remove('dragover')">
                                <input type="file" id="protect-file" accept=".pdf" style="display:none" onchange="updateFileName(this, 'protect')">
                                <div class="file-upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <p>Drop PDF here or click to select</p>
                                <small>PDF files only</small>
                                <div id="protect-filename" class="filename-display"></div>
                            </div>
                        </div>
                    </div>

                    <!-- URL Section -->
                    <div id="protect-url-section" class="input-section">
                        <div class="form-group">
                            <label><i class="fas fa-link"></i> PDF URL:</label>
                            <input type="url" id="protect-url" class="form-control" placeholder="https://example.com/document.pdf">
                        </div>
                    </div>

                    <!-- Settings -->
                    <div class="form-group">
                        <label><i class="fas fa-key"></i> Password:</label>
                        <input type="password" id="protect-password" class="form-control" placeholder="Enter password">
                    </div>

                    <button class="btn" onclick="passwordProtect()">
                        <i class="fas fa-lock"></i> Protect PDF
                    </button>

                    <div id="protect-progress" class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <div id="protect-result" class="result"></div>
                </div>
            </div>

            <!-- Password Remove -->
            <div id="password-remove-page" class="operation-page">
                <div class="operation-card">
                    <h2><i class="fas fa-unlock"></i> Remove Password Protection</h2>
                    
                    <!-- Input Method Toggle -->
                    <div class="input-toggle">
                        <div class="toggle-slider" id="unlock-slider"></div>
                        <div class="toggle-option active" onclick="switchInputMethod('unlock', 'file')">
                            <i class="fas fa-upload"></i> Upload File
                        </div>
                        <div class="toggle-option" onclick="switchInputMethod('unlock', 'url')">
                            <i class="fas fa-link"></i> From URL
                        </div>
                    </div>

                    <!-- File Upload Section -->
                    <div id="unlock-file-section" class="input-section active">
                        <div class="form-group">
                            <div class="file-upload" onclick="document.getElementById('unlock-file').click()" 
                                 ondrop="handleFileDrop(event, 'unlock-file')" 
                                 ondragover="event.preventDefault()" 
                                 ondragenter="event.target.classList.add('dragover')" 
                                 ondragleave="event.target.classList.remove('dragover')">
                                <input type="file" id="unlock-file" accept=".pdf" style="display:none" onchange="updateFileName(this, 'unlock')">
                                <div class="file-upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <p>Drop protected PDF here or click to select</p>
                                <small>Password-protected PDF files</small>
                                <div id="unlock-filename" class="filename-display"></div>
                            </div>
                        </div>
                    </div>

                    <!-- URL Section -->
                    <div id="unlock-url-section" class="input-section">
                        <div class="form-group">
                            <label><i class="fas fa-link"></i> PDF URL:</label>
                            <input type="url" id="unlock-url" class="form-control" placeholder="https://example.com/protected.pdf">
                        </div>
                    </div>

                    <!-- Settings -->
                    <div class="form-group">
                        <label><i class="fas fa-key"></i> Current Password:</label>
                        <input type="password" id="unlock-password" class="form-control" placeholder="Enter current password">
                    </div>

                    <button class="btn" onclick="passwordRemove()">
                        <i class="fas fa-unlock"></i> Remove Password
                    </button>

                    <div id="unlock-progress" class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <div id="unlock-result" class="result"></div>
                </div>
            </div>

            <!-- Image to PDF -->
            <div id="image-to-pdf-page" class="operation-page">
                <div class="operation-card">
                    <h2><i class="fas fa-image"></i> Image to PDF</h2>
                    
                    <!-- Input Method Toggle -->
                    <div class="input-toggle">
                        <div class="toggle-slider" id="image-slider"></div>
                        <div class="toggle-option active" onclick="switchInputMethod('image', 'file')">
                            <i class="fas fa-upload"></i> Upload File
                        </div>
                        <div class="toggle-option" onclick="switchInputMethod('image', 'url')">
                            <i class="fas fa-link"></i> From URL
                        </div>
                    </div>

                    <!-- File Upload Section -->
                    <div id="image-file-section" class="input-section active">
                        <div class="form-group">
                            <div class="file-upload" onclick="document.getElementById('image-file').click()" 
                                 ondrop="handleFileDrop(event, 'image-file')" 
                                 ondragover="event.preventDefault()" 
                                 ondragenter="event.target.classList.add('dragover')" 
                                 ondragleave="event.target.classList.remove('dragover')">
                                <input type="file" id="image-file" accept="image/*" style="display:none" onchange="updateFileName(this, 'image')">
                                <div class="file-upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <p>Drop image here or click to select</p>
                                <small>JPG, PNG, GIF, BMP, TIFF files</small>
                                <div id="image-filename" class="filename-display"></div>
                            </div>
                        </div>
                    </div>

                    <!-- URL Section -->
                    <div id="image-url-section" class="input-section">
                        <div class="form-group">
                            <label><i class="fas fa-link"></i> Image URL:</label>
                            <input type="url" id="image-url" class="form-control" placeholder="https://example.com/image.jpg">
                        </div>
                    </div>

                    <!-- Settings -->
                    <div class="form-group">
                        <label><i class="fas fa-heading"></i> Title (optional):</label>
                        <input type="text" id="image-title" class="form-control" placeholder="Document title">
                    </div>

                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="image-fit-letter">
                            <label for="image-fit-letter"><i class="fas fa-expand-arrows-alt"></i> Fit to letter size (8.5×11)</label>
                        </div>
                    </div>

                    <button class="btn" onclick="imageToPDF()">
                        <i class="fas fa-image"></i> Convert to PDF
                    </button>

                    <div id="image-progress" class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <div id="image-result" class="result"></div>
                </div>
            </div>

            <!-- Make Searchable -->
            <div id="searchable-page" class="operation-page">
                <div class="operation-card">
                    <h2><i class="fas fa-search"></i> Make PDF Searchable</h2>
                    
                    <!-- Input Method Toggle -->
                    <div class="input-toggle">
                        <div class="toggle-slider" id="searchable-slider"></div>
                        <div class="toggle-option active" onclick="switchInputMethod('searchable', 'file')">
                            <i class="fas fa-upload"></i> Upload File
                        </div>
                        <div class="toggle-option" onclick="switchInputMethod('searchable', 'url')">
                            <i class="fas fa-link"></i> From URL
                        </div>
                    </div>

                    <!-- File Upload Section -->
                    <div id="searchable-file-section" class="input-section active">
                        <div class="form-group">
                            <div class="file-upload" onclick="document.getElementById('searchable-file').click()" 
                                 ondrop="handleFileDrop(event, 'searchable-file')" 
                                 ondragover="event.preventDefault()" 
                                 ondragenter="event.target.classList.add('dragover')" 
                                 ondragleave="event.target.classList.remove('dragover')">
                                <input type="file" id="searchable-file" accept=".pdf" style="display:none" onchange="updateFileName(this, 'searchable')">
                                <div class="file-upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <p>Drop scanned PDF here or click to select</p>
                                <small>Scanned or image-based PDF files</small>
                                <div id="searchable-filename" class="filename-display"></div>
                            </div>
                        </div>
                    </div>

                    <!-- URL Section -->
                    <div id="searchable-url-section" class="input-section">
                        <div class="form-group">
                            <label><i class="fas fa-link"></i> PDF URL:</label>
                            <input type="url" id="searchable-url" class="form-control" placeholder="https://example.com/scanned.pdf">
                        </div>
                    </div>

                    <!-- Settings -->
                    <div class="form-group">
                        <label><i class="fas fa-language"></i> OCR Language:</label>
                        <select id="searchable-language" class="form-control">
                            <option value="eng" selected>English</option>
                            <option value="spa">Spanish</option>
                            <option value="fra">French</option>
                            <option value="deu">German</option>
                            <option value="ita">Italian</option>
                            <option value="por">Portuguese</option>
                        </select>
                    </div>

                    <button class="btn" onclick="makeSearchable()">
                        <i class="fas fa-search"></i> Make Searchable
                    </button>

                    <div id="searchable-progress" class="progress">
                        <div class="progress-bar"></div>
                    </div>
                    <div id="searchable-result" class="result"></div>
                </div>
            </div>
            
        </div>
    </div>

    <script>
        // Configuration - Will be populated by server
        const CONFIG = {
            API_BASE_URL: '{{API_BASE_URL}}',
            API_KEY: '{{API_KEY}}'
        };

        // Navigation Functions
        function showMainMenu() {
            // Hide all operation pages
            document.querySelectorAll('.operation-page').forEach(page => {
                page.style.display = 'none';
            });
            
            // Show main menu and hide back button
            document.getElementById('main-menu').style.display = 'block';
            document.querySelector('.back-button').style.display = 'none';
        }

        function showOperation(operationName) {
            // Hide main menu
            document.getElementById('main-menu').style.display = 'none';
            
            // Show back button
            document.querySelector('.back-button').style.display = 'flex';
            
            // Hide all operation pages
            document.querySelectorAll('.operation-page').forEach(page => {
                page.style.display = 'none';
            });
            
            // Show selected operation page
            const pageMap = {
                'compress': 'compress-page',
                'merge': 'merge-page',
                'convert': 'convert-page',
                'watermark': 'watermark-page',
                'password-protect': 'password-protect-page',
                'password-remove': 'password-remove-page',
                'image-to-pdf': 'image-to-pdf-page',
                'searchable': 'searchable-page'
            };
            
            const pageId = pageMap[operationName];
            if (pageId) {
                document.getElementById(pageId).style.display = 'block';
            }
        }

        // Input Method Toggle
        function switchInputMethod(operation, method) {
            const slider = document.getElementById(operation + '-slider');
            const fileSection = document.getElementById(operation + '-file-section');
            const urlSection = document.getElementById(operation + '-url-section');
            const toggleOptions = document.querySelectorAll(`#${operation}-page .toggle-option`);
            
            // Update toggle visual state
            toggleOptions.forEach(option => option.classList.remove('active'));
            event.target.closest('.toggle-option').classList.add('active');
            
            if (method === 'file') {
                slider.classList.remove('url-active');
                fileSection.classList.add('active');
                urlSection.classList.remove('active');
            } else {
                slider.classList.add('url-active');
                fileSection.classList.remove('active');
                urlSection.classList.add('active');
            }
        }

        // File Upload Helpers
        function handleFileDrop(event, inputId) {
            event.preventDefault();
            event.target.classList.remove('dragover');
            
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                const input = document.getElementById(inputId);
                input.files = files;
                updateFileName(input, inputId.split('-')[0]);
            }
        }

        function updateFileName(input, operation) {
            const display = document.getElementById(operation + '-filename');
            if (input.files && input.files.length > 0) {
                if (input.multiple) {
                    display.textContent = `${input.files.length} files selected`;
                } else {
                    display.textContent = input.files[0].name;
                }
                display.style.display = 'block';
            }
        }

        // Progress Management
        function showProgress(operation) {
            const progressEl = document.getElementById(operation + '-progress');
            progressEl.style.display = 'block';
            const bar = progressEl.querySelector('.progress-bar');
            bar.style.width = '10%';
            
            let progress = 10;
            const interval = setInterval(() => {
                progress += Math.random() * 20;
                if (progress > 90) progress = 90;
                bar.style.width = progress + '%';
            }, 500);
            
            return interval;
        }

        function hideProgress(operation, interval) {
            clearInterval(interval);
            const progressEl = document.getElementById(operation + '-progress');
            const bar = progressEl.querySelector('.progress-bar');
            bar.style.width = '100%';
            setTimeout(() => {
                progressEl.style.display = 'none';
                bar.style.width = '0%';
            }, 500);
        }

        function showResult(operation, result, isError = false) {
            const resultEl = document.getElementById(operation + '-result');
            resultEl.className = 'result ' + (isError ? 'error' : 'success');
            resultEl.style.display = 'block';
            
            if (isError) {
                resultEl.innerHTML = `<strong><i class="fas fa-exclamation-triangle"></i> Error:</strong> ${result}`;
            } else if (result.url) {
                resultEl.innerHTML = `
                    <strong><i class="fas fa-check-circle"></i> Success!</strong><br>
                    ${result.mb_saved ? `Saved ${result.mb_saved} MB (${result.percent_reduction}% reduction)` : 'Processing completed'}
                    <a href="${result.url}" class="download-link" target="_blank">
                        <i class="fas fa-download"></i> Download Result
                    </a>
                `;
            } else if (result.content_base64) {
                const blob = base64ToBlob(result.content_base64, result.content_type);
                const url = URL.createObjectURL(blob);
                resultEl.innerHTML = `
                    <strong><i class="fas fa-check-circle"></i> Success!</strong><br>
                    ${result.mb_saved ? `Saved ${result.mb_saved} MB (${result.percent_reduction}% reduction)` : 'Processing completed'}
                    <a href="${url}" class="download-link" download="${result.filename}">
                        <i class="fas fa-download"></i> Download Result
                    </a>
                `;
            } else {
                resultEl.innerHTML = `<strong><i class="fas fa-check-circle"></i> Success!</strong><br>${JSON.stringify(result, null, 2)}`;
            }
        }

        function base64ToBlob(base64, contentType) {
            const byteCharacters = atob(base64);
            const byteNumbers = new Array(byteCharacters.length);
            for (let i = 0; i < byteCharacters.length; i++) {
                byteNumbers[i] = byteCharacters.charCodeAt(i);
            }
            const byteArray = new Uint8Array(byteNumbers);
            return new Blob([byteArray], { type: contentType });
        }

        // API Call Helper
        async function callAPI(endpoint, formData) {
            const response = await fetch(endpoint, {
                method: 'POST',
                headers: {
                    'x-api-key': CONFIG.API_KEY
                },
                body: formData
            });

            if (!response.ok) {
                const error = await response.json();
                throw new Error(error.detail || `HTTP ${response.status}`);
            }

            return await response.json();
        }

        // PDF Operations (same as before)
        async function compressPDF() {
            const file = document.getElementById('compress-file').files[0];
            const url = document.getElementById('compress-url').value;
            const level = document.getElementById('compress-level').value;
            const maxPages = document.getElementById('compress-max-pages').value;

            if (!file && !url) {
                alert('Please select a file or enter a URL');
                return;
            }

            const formData = new FormData();
            if (file) formData.append('file', file);
            if (url) formData.append('file_url', url);
            formData.append('compression_level', level);
            formData.append('return_type', 'url');
            if (maxPages) formData.append('max_pages', maxPages);

            const progress = showProgress('compress');
            try {
                const result = await callAPI('/compress', formData);
                showResult('compress', result);
            } catch (error) {
                showResult('compress', error.message, true);
            } finally {
                hideProgress('compress', progress);
            }
        }

        async function mergePDFs() {
            const files = document.getElementById('merge-files').files;
            const urls = document.getElementById('merge-urls').value;

            if (files.length === 0 && !urls) {
                alert('Please select files or enter URLs');
                return;
            }

            const formData = new FormData();
            for (let file of files) {
                formData.append('files', file);
            }
            if (urls) formData.append('file_urls', urls);
            formData.append('return_type', 'url');

            const progress = showProgress('merge');
            try {
                const result = await callAPI('/merge', formData);
                showResult('merge', result);
            } catch (error) {
                showResult('merge', error.message, true);
            } finally {
                hideProgress('merge', progress);
            }
        }

        async function addWatermark() {
            const file = document.getElementById('watermark-file').files[0];
            const url = document.getElementById('watermark-url').value;
            const text = document.getElementById('watermark-text').value;
            const opacity = document.getElementById('watermark-opacity').value;
            const position = document.getElementById('watermark-position').value;

            if (!file && !url) {
                alert('Please select a file or enter a URL');
                return;
            }

            const formData = new FormData();
            if (file) formData.append('file', file);
            if (url) formData.append('file_url', url);
            formData.append('text', text);
            formData.append('opacity', opacity);
            formData.append('position', position);
            formData.append('return_type', 'url');

            const progress = showProgress('watermark');
            try {
                const result = await callAPI('/watermark', formData);
                showResult('watermark', result);
            } catch (error) {
                showResult('watermark', error.message, true);
            } finally {
                hideProgress('watermark', progress);
            }
        }

        async function passwordProtect() {
            const file = document.getElementById('protect-file').files[0];
            const url = document.getElementById('protect-url').value;
            const password = document.getElementById('protect-password').value;

            if (!file && !url) {
                alert('Please select a file or enter a URL');
                return;
            }

            if (!password) {
                alert('Please enter a password');
                return;
            }

            const formData = new FormData();
            if (file) formData.append('file', file);
            if (url) formData.append('file_url', url);
            formData.append('password', password);
            formData.append('return_type', 'url');

            const progress = showProgress('protect');
            try {
                const result = await callAPI('/password-protect', formData);
                showResult('protect', result);
            } catch (error) {
                showResult('protect', error.message, true);
            } finally {
                hideProgress('protect', progress);
            }
        }

        async function passwordRemove() {
            const file = document.getElementById('unlock-file').files[0];
            const url = document.getElementById('unlock-url').value;
            const password = document.getElementById('unlock-password').value;

            if (!file && !url) {
                alert('Please select a file or enter a URL');
                return;
            }

            if (!password) {
                alert('Please enter the current password');
                return;
            }

            const formData = new FormData();
            if (file) formData.append('file', file);
            if (url) formData.append('file_url', url);
            formData.append('password', password);
            formData.append('return_type', 'url');

            const progress = showProgress('unlock');
            try {
                const result = await callAPI('/password-remove', formData);
                showResult('unlock', result);
            } catch (error) {
                showResult('unlock', error.message, true);
            } finally {
                hideProgress('unlock', progress);
            }
        }

        async function convertToPDF() {
            const file = document.getElementById('convert-file').files[0];
            const url = document.getElementById('convert-url').value;
            const title = document.getElementById('convert-title').value;
            const fitToLetter = document.getElementById('convert-fit-letter').checked;

            if (!file && !url) {
                alert('Please select a file or enter a URL');
                return;
            }

            const formData = new FormData();
            if (file) formData.append('file', file);
            if (url) formData.append('file_url', url);
            if (title) formData.append('title', title);
            formData.append('fit_to_letter', fitToLetter);
            formData.append('return_type', 'url');

            const progress = showProgress('convert');
            try {
                const result = await callAPI('/convert-to-pdf', formData);
                showResult('convert', result);
            } catch (error) {
                showResult('convert', error.message, true);
            } finally {
                hideProgress('convert', progress);
            }
        }

        async function imageToPDF() {
            const file = document.getElementById('image-file').files[0];
            const url = document.getElementById('image-url').value;
            const title = document.getElementById('image-title').value;
            const fitToLetter = document.getElementById('image-fit-letter').checked;

            if (!file && !url) {
                alert('Please select a file or enter a URL');
                return;
            }

            const formData = new FormData();
            if (file) formData.append('file', file);
            if (url) formData.append('file_url', url);
            if (title) formData.append('title', title);
            formData.append('fit_to_letter', fitToLetter);
            formData.append('return_type', 'url');

            const progress = showProgress('image');
            try {
                const result = await callAPI('/image-to-pdf', formData);
                showResult('image', result);
            } catch (error) {
                showResult('image', error.message, true);
            } finally {
                hideProgress('image', progress);
            }
        }

        async function makeSearchable() {
            const file = document.getElementById('searchable-file').files[0];
            const url = document.getElementById('searchable-url').value;
            const language = document.getElementById('searchable-language').value;

            if (!file && !url) {
                alert('Please select a file or enter a URL');
                return;
            }

            const formData = new FormData();
            if (file) formData.append('file', file);
            if (url) formData.append('file_url', url);
            formData.append('language', language);
            formData.append('return_type', 'url');

            const progress = showProgress('searchable');
            try {
                const result = await callAPI('/make-searchable', formData);
                showResult('searchable', result);
            } catch (error) {
                showResult('searchable', error.message, true);
            } finally {
                hideProgress('searchable', progress);
            }
        }


    </script>
</body>
</html>